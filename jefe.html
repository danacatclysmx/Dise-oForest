<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Configuración básica del documento -->
    <meta charset="UTF-8">
    <!-- Meta viewport para responsividad -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conglomerados</title>
    
    <!-- Estilos externos -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" /> <!-- Mapas interactivos -->
    <link rel="stylesheet" href="jefecss.css"> <!-- Estilos personalizados -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"> <!-- Iconos -->
</head>
<body>
    <div class="container">
        <!-- Menú hamburguesa para dispositivos móviles -->
        <button class="menu-toggle" id="menuToggle">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <!-- Overlay para cerrar menú lateral -->
        <div class="overlay" id="overlay"></div>
        
        <!-- Menú lateral de navegación -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">Menú</h2>
            </div>
            <ul class="sidebar-menu">
                <!-- Opciones de menú con iconos -->
                <li class="menu-item active" data-section="conglomerados">
                    <i class="fas fa-list"></i>
                    <span>Lista de Conglomerados</span>
                </li>
                <li class="menu-item" data-section="papelera">
                    <i class="fas fa-trash"></i>
                    <span>Papelera</span>
                </li>
                <li class="menu-item" data-section="calculadora">
                    <i class="fas fa-calculator"></i>
                    <span>Calculadora de Áreas</span>
                </li>
            </ul>
            <!-- Botón para crear nuevo conglomerado -->
            <div class="create-button" id="createButton">
                <i class="fas fa-plus"></i> CREAR
            </div>
        </div>

        <!-- Modal para crear nuevos conglomerados -->
        <div class="modal-overlay" id="modalCrear">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">CREAR NUEVO CONGLOMERADO</div>
                    <button class="close-button" id="closeCrearModal">&times;</button>
                </div>
                <!-- Formulario de creación con validación -->
                <form id="formCrearConglomerado">
                    <!-- Campos de formulario -->
                    <div class="form-group">
                        <label for="departamento">Departamento:</label>
                        <input type="text" id="departamento" name="departamento" required>
                    </div>
                    <div class="form-group">
                        <label for="municipio">Municipio:</label>
                        <input type="text" id="municipio" name="municipio" required>
                    </div>
                    <div class="form-group">
                        <label for="corregimiento">Corregimiento:</label>
                        <input type="text" id="corregimiento" name="corregimiento">
                    </div>
                    <div class="form-group">
                        <label for="coordenadas">Coordenadas Centro:</label>
                        <!-- Validación de formato de coordenadas -->
                        <input type="text" id="coordenadas" name="coordenadas" 
                               placeholder="Ej: 04°32'15.67\"N 74°12'45.89\"W" required
                               pattern="\d+°\d+['’]\d+(\.\d+)?['’][\"”][NS]\s+\d+°\d+['’]\d+(\.\d+)?['’][\"”][EW]"
                               title="Formato: DD°MM'SS.SS\"N DD°MM'SS.SS\"W">
                    </div>
                    <!-- Fechas de inicio y fin -->
                    <div class="form-group">
                        <label for="fechaInicio">Fecha de Inicio:</label>
                        <input type="date" id="fechaInicio" name="fechaInicio" required>
                    </div>
                    <div class="form-group">
                        <label for="fechaFin">Fecha de Finalización:</label>
                        <input type="date" id="fechaFin" name="fechaFin" required>
                    </div>
                    <div class="form-group">
                        <label for="precision">Precisión GPS:</label>
                        <input type="text" id="precision" name="precision" placeholder="Ej: ±0.35 m" required>
                    </div>
                    <!-- Punto de referencia -->
                    <h3>Punto de Referencia</h3>
                    <div class="form-group">
                        <label for="puntoTipo">Tipo:</label>
                        <input type="text" id="puntoTipo" name="puntoTipo" placeholder="Ej: Árbol destacado">
                    </div>
                    <div class="form-group">
                        <label for="puntoAzimut">Azimut:</label>
                        <input type="text" id="puntoAzimut" name="puntoAzimut" placeholder="Ej: 45°">
                    </div>
                    <div class="form-group">
                        <label for="puntoDistancia">Distancia horizontal:</label>
                        <input type="text" id="puntoDistancia" name="puntoDistancia" placeholder="Ej: 15 m">
                    </div>
                    <!-- Botones de acción -->
                    <div class="action-buttons">
                        <button type="button" class="action-button reject-button" id="cancelarCrear">CANCELAR</button>
                        <button type="submit" class="action-button approve-button">GUARDAR</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal de calculadora de áreas -->
        <div class="modal-overlay" id="modalCalculadora">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">CALCULADORA DE ÁREAS</div>
                    <button class="close-button" id="closeCalculadoraModal">&times;</button>
                </div>
                <div class="calculator-container">
                    <div class="calculator-tabs">
                        <div class="calculator-tab active" data-figure="circulo">Círculo</div>
                        <div class="calculator-tab" data-figure="cuadrado">Cuadrado</div>
                        <div class="calculator-tab" data-figure="triangulo">Triángulo</div>
                    </div>
                    
                    <div class="calculator-content">
                        <!-- Formulario para círculo -->
                        <div class="calculator-form" id="formCirculo">
                            <div class="form-group">
                                <label for="radio">Radio (metros):</label>
                                <input type="number" id="radio" step="0.01" min="0">
                            </div>
                            <button class="action-button calculate-button" data-figure="circulo">CALCULAR ÁREA</button>
                            <div class="result-container">
                                <h4>Resultado:</h4>
                                <p id="resultadoCirculo">-</p>
                            </div>
                        </div>
                        
                        <!-- Formulario para cuadrado -->
                        <div class="calculator-form" id="formCuadrado" style="display: none;">
                            <div class="form-group">
                                <label for="lado">Lado (metros):</label>
                                <input type="number" id="lado" step="0.01" min="0">
                            </div>
                            <button class="action-button calculate-button" data-figure="cuadrado">CALCULAR ÁREA</button>
                            <div class="result-container">
                                <h4>Resultado:</h4>
                                <p id="resultadoCuadrado">-</p>
                            </div>
                        </div>
                        
                        <!-- Formulario para triángulo -->
                        <div class="calculator-form" id="formTriangulo" style="display: none;">
                            <div class="form-group">
                                <label for="base">Base (metros):</label>
                                <input type="number" id="base" step="0.01" min="0">
                            </div>
                            <div class="form-group">
                                <label for="altura">Altura (metros):</label>
                                <input type="number" id="altura" step="0.01" min="0">
                            </div>
                            <button class="action-button calculate-button" data-figure="triangulo">CALCULAR ÁREA</button>
                            <div class="result-container">
                                <h4>Resultado:</h4>
                                <p id="resultadoTriangulo">-</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Título principal -->
        <h1 id="mainTitle">CONGLOMERADOS</h1>
        
        <!-- Mensaje de bienvenida personalizado -->
        <div id="welcomeMessage" class="welcome-message"></div>
        
        <!-- Filtros por estado -->
        <div class="status-tabs" id="statusTabs">
            <div class="status-tab active" data-status="pendientes" onclick="filterConglomerados('pendientes', event)">PENDIENTES</div>
            <div class="status-tab" data-status="aprobados" onclick="filterConglomerados('aprobados', event)">APROBADOS</div>
            <div class="status-tab" data-status="rechazados" onclick="filterConglomerados('rechazados', event)">RECHAZADOS</div>
        </div>
        
        <!-- Contenedor para listado dinámico de conglomerados -->
        <div id="conglomeradosContainer">
            <!-- Los conglomerados se cargarán dinámicamente aquí -->
        </div>
    </div>

    <!-- Modal de detalles de conglomerado -->
    <div class="modal-overlay" id="modalDetalles">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalConglomeradoId"></div>
                <button class="close-button" id="closeModal">&times;</button>
            </div>
            <!-- Sección de información general -->
            <div class="modal-section">
                <div class="info-grid">
                    <div class="info-item"><strong>Fecha de Inicio:</strong> <span id="fechaInicioDetalle"></span></div>
                    <div class="info-item"><strong>Fecha de Finalización:</strong> <span id="fechaFinDetalle"></span></div>
                    <div class="info-item"><strong>Departamento:</strong> <span id="departamentoDetalle"></span></div>
                    <div class="info-item"><strong>Municipio:</strong> <span id="municipioDetalle"></span></div>
                    <div class="info-item"><strong>Corregimiento:</strong> <span id="corregimientoDetalle"></span></div>
                    <div class="info-item"><strong>Coordenadas Centro:</strong> <span id="coordenadasDetalle"></span></div>
                    <div class="info-item"><strong>Aprobado por:</strong> <span id="aprobadoPorDetalle"></span></div>
                    <div class="info-item"><strong>Precisión GPS:</strong> <span id="precisionDetalle"></span></div>
                    <div class="info-item"><strong>Fecha Aprobación:</strong> <span id="fechaAprobacionDetalle"></span></div>
                    <div class="info-item"><strong>Estado:</strong> <span id="estadoDetalle"></span></div>
                </div>
            </div>
            <!-- Mapa de subparcelas -->
            <div class="divider"></div>
            <div class="modal-section">
                <h3>Mapa de Subparcelas</h3>
                <div id="map-container">
                    <div id="map"></div> <!-- Contenedor para mapa Leaflet -->
                </div>
            </div>
            <!-- Información de puntos de referencia -->
            <div class="divider"></div>
            <div class="modal-section">
                <h3>Puntos de Referencia</h3>
                <div class="punto-referencia">
                    <div><strong>Tipo:</strong> <span id="puntoTipoDetalle"></span></div>
                    <div><strong>Azimut:</strong> <span id="puntoAzimutDetalle"></span></div>
                    <div><strong>Distancia horizontal:</strong> <span id="puntoDistanciaDetalle"></span></div>
                </div>
            </div>
            <!-- Tabla de subparcelas -->
            <div class="divider"></div>
            <div class="modal-section">
                <h3>Subparcelas</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Subparcela</th>
                            <th>Radio</th>
                            <th>Azimut</th>
                            <th>Distancia al Centro</th>
                            <th>Materializado</th>
                            <th>Color</th>
                            <th>Posición</th>
                        </tr>
                    </thead>
                    <tbody id="subparcelasTable">
                        <!-- Datos de subparcelas se llenarán dinámicamente -->
                    </tbody>
                </table>
            </div>
            <!-- Botones de acción dinámicos -->
            <div class="action-buttons" id="actionButtons"></div>
        </div>
    </div>

    <!-- Scripts necesarios -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script> <!-- Librería de mapas -->
    <script src="jefejs.js"></script> <!-- Lógica de aplicación -->
</body>
</html>